c
c   Bubble sorting.
c   Variant by Rafael Safarov, 1985.
c
        subroutine bubble(a, n)
        integer a(n), u
        n1 = n - 1
        do 20 i = 1, n1
            k = i
 10         j = k + 1
            if (a(k) .le. a(j)) goto 20
                u = a(k)
                a(k) = a(j)
                a(j) = u
                k = k - 1
                if (k .ge. 1) goto 10
 20         continue
        return
        end
c
        program test
        integer a(100)
        data a /-9, 932, 6, -566, 123, 794, -248, -528, 200, 472,
     +          -605, -428, -716, 300, -83, -653, 82, -574, -400, -467,
     +          116, -613, 809, -693, -456, -777, 757, 122, 861, -631,
     +          -917, 457, -635, 838, -732, 39, -612, -820, 134, 354,
     +          723, -278, 368, -759, 372, 953, 531, -234, -948, -428,
     +          21, -862, -530, -848, 354, 180, -280, 430, -495, -323,
     +          -26, 256, 742, -970, 94, 805, -214, -457, 536, 564,
     +          -25, -352, -283, 972, -217, 153, 12, -989, 126, -210,
     +          -2, 593, 732, -142, 548, 0, -877, 865, 107, 803,
     +          929, 999, 0, -387, 489, 160, 856, 784, -251, 330/
        call bubble(a, 100)
        print 1000, a
 1000   format (10(10i6, /))
        end
