c
c   Sorting by Shell's method.
c   Variant by Rafael Safarov, 1985.
c
        subroutine shell(a, n)
        integer a(n), d, x
        d = 1
 10     d = 2 * d
        if (d .le. n) goto 10
 20     d = (d - 1) / 2
        if (d .eq. 0) return
        nd = n - d
        do 40 i = 1, nd
            j = i
 30         l = j + d
            if (a(l) .ge. a(j)) goto 40
                x = a(j)
                a(j) = a(l)
                a(l) = x
                j = j - d
                if (j .gt. 0) goto 30
 40         continue
        goto 20
        end
c
        program test
        integer a(100)
        data a /979, 904, -528, 396, -713, 282, 510, 55, 227, -427,
     +          440, -730, -343, 307, -197, -981, -74, -568, 185, 446,
     +          102, 259, 191, 359, -373, -257, 821, 894, 751, -454,
     +          -39, 887, -432, -45, 373, 779, 549, -405, -9, 849,
     +          907, 495, -704, -497, -561, 820, 238, 575, -735, -174,
     +          589, -915, -813, 996, 266, 355, 171, 454, -169, 2,
     +          883, 207, 445, -714, 757, -892, 422, -488, -952, 229,
     +          -267, 427, 535, 201, -658, -351, -324, -638, 35, 534,
     +          -605, -877, 686, 205, 6, -624, 520, 419, -85, 484,
     +          -89, 626, -44, 542, 578, -951, -590, -250, 768, 532/
        call shell(a, 100)
        print 1000, a
 1000   format (10(10i6, /))
        end
